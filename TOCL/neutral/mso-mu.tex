\section{Monadic second-order logics and modal $\mu$-calculi}
\label{s:mso-mu}

In this section we introduce the main logics of our narrative, i.e., the 
weak and noetherian versions of monadic second-order logic, and the two 
continuous and noetherian fragments of the modal $\mu$-calculus.

 \subsection{Monadic second-order logics}
\label{sec:prel-so}
% \input{yde/prelim/prel-so}

Three variants of monadic second-order logic feature in our work:
\emph{standard}, \emph{weak}, and \emph{noetherian} monadic second-order 
logic, and for each of these three variants, we consider a one-sorted and 
a two-sorted version.
As we will see later, the one-sorted version fits better in the 
automata-theoretic framework, whereas it is more convenient to use the 
two-sorted approach when translating $\mu$-calculi into second order languages.
In both the one-sorted and the two-sorted version, the syntax of the three 
languages is the same, the difference lying in the semantics, more specificaly,
in the type of subsets over which the second-order quantifiers range.
In the case of standard and weak monadic second-order logic, these quantifiers 
range over all, respectively, all finite subsets of the model.
In the case of \nmso we need the concept of a \emph{noetherian} subset of an LTS.

\begin{definition}
\label{d:bundle1}
Let $\bbS = \tup{T,R,\tscolors, s_I}$ be an LTS, and let $B$ be a non-empty set 
of finite paths that all share the same starting point $s$; we call $B$ a 
\emph{bundle rooted at} $s$, or simply an $s$-\emph{bundle}, if $B$ does not
contain an infinite ascending chain $\pi_{0} \sqsubset \pi_{1} \sqsubset 
\cdots$, where $\sqsubset$ denotes the (strict) initial-segment relation on 
paths.
A \emph{bundle} is simply an $s$-bundle for some $s \in T$.

A subset $X$ of $T$ is called \emph{noetherian} if there is a bundle $B$ such
that each $t \in X$ lies on some path in $B$.
\end{definition}

Notice that in a tree model, the noetherian subsets coincide with those that
are included in a well-founded subtree.

\btbs
\item \textcolor{red}{example of noetherian subset of non-tree model to be added}
\item \textcolor{red}{example explaining difference between noetherian and 
finite subset, in finite model?}
\etbs

\subsubsection*{One-sorted monadic second-order logics}
%
\begin{definition}\label{def:mso}
The formulas of the \emph{(one-sorted) monadic second-order language} are
defined by the following grammar:
%
\begin{eqnarray*}\label{EQ_mso}
  \phi \isbnf  \here{p} \mid p \inc q \mid R(p,q) \mid \lnot\phi 
     \mid \phi\lor\phi \mid \exists p.\phi,
\end{eqnarray*}
where $p$ and $q$ are letters from $\Prop$.
We  adopt the standard convention that no proposition letter is both free and
bound in $\phi$.
\end{definition}


As mentioned, the three logics $\smso$, $\wmso$ and $\nmso$ are distinguished by
their semantics. 
Let  $\bbS = \tup{T,R,\tscolors, s_I}$ be an LTS.
The interpretation of the atomic formulas is fixed:
\begin{align*}
\bbS \models \here{p} & \quad\text{ iff }\quad  \tsval(p) = \{s_I\} \\
\bbS \models p \inc q & \quad\text{ iff }\quad  \tsval(p) \subseteq \tsval(q) \\
\bbS \models R(p,q) & \quad\text{ iff }\quad  \text{for every $s\in \tsval(p)$ there exists $t\in \tsval(q)$ such that $sRt$} 
\end{align*}
Furthermore, the interpretation of the boolean connectives is standard.
The interpretation of the existential quantifier is where the logics diverge:

\begin{align*}
\bbS \models\ \exists p. \phi  & \quad\text{ iff }\quad  \bbS[p \mapsto X] \models \phi \,
\left.\begin{cases}
   \text{for some }                   & (\smso)
\\ \text{for some \emph{finite} }     & (\wmso) 
\\ \text{for some \emph{noetherian} } & (\nmso)
\end{cases}\right\}\,
 X \subseteq T.
\end{align*}

Observe that for a given monadic second-order formula $\phi$, the classes 
$\Mod_{\smso}(\phi)$, $\Mod_{\wmso}(\phi)$ and $\Mod_{\nmso}(\phi)$ will 
generally be different.

\subsubsection*{Two-sorted monadic second-order logics}
The reader may have expected to see the following more standard language for
second-order logic.
\begin{definition}
\label{def:2mso}
Given a set $\fovar$ of individual (first-order) variables, we define the 
formulas of the \emph{two-sorted monadic second-order language} by the following
grammar:
\[
\phi \isbnf  p(x)
%\mid X(y)
\mid R(x,y)
\mid x \foeq y
\mid \neg \phi
\mid \phi \lor \phi
\mid \exists x.\phi
\mid \exists p.\phi
\]
where $p \in \Prop$, $x,y \in \fovar$ and $\foeq$ is the symbol for equality.   
\end{definition}

Formulas are interpreted over an LTS $\bbS = \tup{T,R,\tscolors, s_I}$ with a
variable assignment $g: \fovar \to T$, and the semantics of the language is
completely standard. 
Depending on whether second-order quantification ranges over all subsets, over 
finite subsets or over noetherian subsets, we obtain the three two-sorted 
variants denoted respectively as $2\smso$, $2\wmso$ and $2\nmso$.

%\begin{remark}
\subsubsection*{Equivalence of the two versions}
In each variant, the one-sorted and the two-sorted versions can be proved to
be equivalent, but there is a sublety due to the fact that our models have a 
distinguished state.
In the one-sorted language, we use the downarrow $\here$ to access this
distinguished state; in the two-sorted approach, we will use a \emph{fixed}
variable $v$ to refer to the distinguished state, and given a formula 
$\phi(v)$ of which $v$ is the only free individual variable, we write 
$\bbS \models \phi[s_{I}]$ rather than $\bbS[v \mapsto s_{I}] \models \phi$.
As a consequence, the proper counterpart of the one-sorted language $\smso$ is
the set $2\smso(v)$ of those $2\smso$-formulas that have precisely $v$ 
as their unique free variable.

More in particular, with $L \in \{\smso, \wmso, \nmso\}$, we say that $\phi \in
L$ is \emph{equivalent to} $\psi(v) \in L(v)$ if
\[
\bbS \models \phi \text{ iff } \bbS \models \psi[s_{I}]
\]
for every model $\bbS = \tup{T,R,\tscolors, s_I}$.
We can now state the equivalence between the two approaches to 
monadic second-order logic as follows.

\begin{proposition}
\label{p:msovs2mso}
Let $L \in \{\smso, \wmso, \nmso\}$ be a monadic second-order logic.
\begin{enumerate}
\item
There is an effective construction transforming a formula $\phi \in L$ into
an equivalent formula $\phi^{t} \in 2L(v)$.
\item
There is an effective construction transforming a formula $\psi \in 2L(v)$ into
an equivalent formula $\psi^{o} \in L$.
\end{enumerate}
\end{proposition}

\begin{proof}
Since it is completely straightforward to define a translation $(\cdot)^{t}$ as 
required for part (1) of Fact~\ref{fact:msovs2mso}, we only discuss the proof 
of part (2). 
The key observation here is that a single-sorted language can interpret the 
corresponding two-sorted language by encoding every individual variable $x \in 
\fovar$ as a set variable $p_x$ denoting a singleton, and that it is easy to 
write down a formula stating that a variable indeed is interpreted by a 
singleton.
As a consequence, where $2\yvlang(\pprop,\mathsf{X})$ denotes the set of
$2L$-formulas with free second-order variables in $\pprop$ and free first-order
variables in $\mathsf{X}$, it is not hard to formulate a translation 
$(\cdot)^{m} : 2\yvlang(\pprop,\mathsf{X}) \to \yvlang(\pprop \uplus 
\{ p_{x} \mid x \in \mathsf{X} \})$
such that, for every model $\bbS$, every variable assignment $g$ and every
formula $\psi \in 2\yvlang(\Prop,\mathsf{X})$:
\[
\bbS,g \models \psi \quad\text{iff}\quad 
\bbS[p_{x} \mapsto \{g(x)\} \mid x \in \mathsf{X}] \models \psi^m.
\]
From this it is immediate that any $\psi \in 2L(v)$ satisfies
\[
\bbS \models \psi[s_{I}]
\quad\text{iff}\quad 
\bbS \models \exists p_{v} (\here{p_{v}} \land \psi^{m}),
\]
so that we may take $\psi^{o} \isdef \exists p_{v} (\here{p_{v}} \land 
\psi^{m})$.
\end{proof}

Finally, we compare the relative expressive power of the logics $\smso$, $\wmso$
and $\nmso$.

\begin{example}
\btbs
\item \textcolor{red}{($\nmso \leq \smso$) EXAMPLE NEEDED}
\item
\textcolor{red}{($\wmso \not\leq \nmso,\smso$) 
In $\wmso$ we can express that every point has infinitely many successors, while
this property is not expressible in $\smso$ (and hence, not in $\nmso$ either).
}
\item \textcolor{red}{MORE EXAMPLES TO BE ADDED}
\etbs
\end{example}

\subsection{Some model-theoretic observations}

\btbs
\item
introduction
\item
\begin{definition}
Let $F: \wp S \to \wp S$ be a map.
We say that $F$ is \emph{monotone} if $F(X) \sse F(Y)$ whenever $X \sse Y$, and 
\emph{continuous} if it is monotone and satisfies 
\begin{equation}
F(X) = \bigcap \{ F(Y) \mid Y \sse X, Y \text{ finite} \}.
\end{equation}
\btbs
\item
In case $S$ is the domain of a tree model, we call $F$
\emph{noetherian-based} if it is monotone, and satisfies the following 
condition
\begin{equation}
F(X) = \bigcap \{ F(Y) \mid Y \sse X, Y \text{ noetherian} \}.
\end{equation}
\etbs
\end{definition}
\item
Recall that in the standard $\mu$-calculus, there is a syntactic restriction on
the formation of a formula $\mu p. \phi$, viz.,, we require that the formula 
$\phi$ is \emph{positive} in $p$
\item
reason is semantic: apply K-T theorem
\item
monotonicity is 
\etbs

\subsection{Fragments of the modal $\mu$-calculus}

Formulas of the modal $\mu$-calculus may be classified according to their
\emph{alternation depth}, which roughly is given as the maximal length of
a chain of nested alternating least and greatest fixpoint operators~\cite{Niwinski86}.
The \emph{alternation-free fragment} of the modal $\mu$-calculus~($\AFMC$) is 
usually defined as the collection of $\muML$-formulas without nesting of least
and greatest fixpoint operators. 
It can also be also given a more standard grammatical definition as follows.

\begin{definition}
Given a set $\qprop$ of propositional variables, we define the fragment 
$\noe{\mu\ML}{\qprop}$ of \muML-formulas that are (syntactically) 
\emph{noetherian} in $\qprop$, by the following grammar:
\begin{equation*}
   \phi \isbnf  q
   \mid \psi
   \mid \phi \lor \phi
   \mid \phi \land \phi
     \mid \Diamond \phi
       \mid \Box \phi
   \mid \mu p.\phi'
\end{equation*}
where $q \in \qprop$, $\psi$ is a $\qprop$-free $\muML$-formula, and 
$\phi' \in \noe{\mu\ML}{\qprop\cup\{p\}}$. 
The \emph{co-noetherian} fragment $\conoe{\mu\ML}{Q}$ is defined dually.
\end{definition}

The alternation-free $\mu$-calculus can be defined as the fragment of the full
language where we restrict the application of the least fixpoint operator $\mu
p$ to formulas that are noetherian in $p$ (and apply a dual condition to the 
greatest fixpoint operator).

\begin{definition}
The formulas of the \emph{alternation-free} $\mu$-calculus $\AFMC$ 
are defined by the following grammar:
\begin{equation*}
   \phi \isbnf  
      q \mid \neg q  
   \mid \phi\lor\phi \mid \phi\land\phi 
      \mid \Diamond \phi
       \mid \Box \phi
   \mid \mu p. \phi'    
   \mid \nu p. \phi'',
\end{equation*} 
where $p,q \in \Prop$, $\phi' \in \AFMC \cap \noe{\mu\ML}{p}$
and dually $\phi'' \in \AFMC \cap \conoe{\mu\ML}{p}$.
\end{definition}

It is then immediate to verify that the above definition indeed captures exactly
all formulas without alternation of least and greatest fixpoints.
One may prove that 
% \begin{fact}
a formula $\phi \in \muML$ belongs to the fragment $\AFMC$ iff for all 
subformulas $\mu p.\psi_1$ and $\nu q.\psi_2$ it holds that $p$ is not free in
$\psi_2$ and $q$ is not free in $\psi_1$.
% \end{fact}
%
Over arbitrary transition systems, this fragment is less expressive than the 
whole $\muML$~\cite{Park79}. 

In order to properly define the fragment $\mucML \subseteq \AFMC$ which is of
critical importance in this article, we are particularly interested in the 
\emph{continuous} fragment of the modal $\mu$-calculus. 
As observed in Section~\ref{sec:intro}, the abstract notion of continuity can 
be given a concrete interpretation in the context of $\mu$-calculus.
%
\begin{definition}
Let $\phi \in \muML$, and $q$ be a propositional variable. 
We say that \emph{$\phi$ is continuous in $q$} iff for every transition 
system $\bbS$ there exists some finite $S \subseteq_\omega \tsval(q)$ such that
$$
\bbS \mmodels \phi \quad\text{iff}\quad \bbS[q \mapsto S] \mmodels \phi.
$$
\end{definition}

We can give a syntactic characterisation of the fragment of $\muML$ that captures
this property. 

\begin{definition}
Given a set $\qprop$ of propositional variables, we define the fragment of \muML 
\emph{continuous} in $\qprop$, denoted by $\cont{\muML}{\qprop}$, by induction 
in the following way
\begin{equation*}
   \phi \isbnf  q
   \mid \psi
   \mid \phi \lor \phi
   \mid \phi \land \phi
   \mid \Diamond \phi
   \mid \mu p.\phi'
\end{equation*}
%
where $q,p \in \qprop$, $\psi$ is a $\qprop$-free $\muML$-formula and 
$\phi' \in \cont{\muML}{\qprop\cup\{p\}}$.

The  \emph{co-continuous} fragment $\cocont{\mu\ML}{Q}$ is defined dually. 
\end{definition}

\begin{proposition}[\cite{Fontaine08,FV12}]\label{prop:FVcont}
A $\muML$-formula is continuous in $q$ iff it is equivalent to a formula in the
fragment $\cont{\muML}{q}$.
\end{proposition}

Finally, we define $\mucML$ to be the fragment of $\muML$ where the use of the
least fixed point operator is restricted to the continuous fragment. 

\begin{definition}
Formulas of the fragment $\mucML$ are given by:% the following induction:
\begin{equation*}
   \phi \isbnf  q \mid \lnot q
    \mid \phi \lor \phi
        \mid \phi \land \phi
    \mid \Diamond \phi
     \mid \Box \phi \mid
    \mu p.\phi' 
    \mid \nu p.\phi''
    \end{equation*}
%
where $p,q \in \Prop$,  $\phi' \in \cont{\muML}{p} \cap \mucML$, and dually 
$\phi'' \in \cocont{\muML}{p} \cap \mucML$.
\end{definition}

% \begin{proposition}
% The following hold for any formula $\phi \in \mucML$:
% \begin{enumerate}[(1)]
% \itemsep 0pt
% \item $\phi$ is an $\AFMC$-formula,
% \item 
% Every $\mu$-variable in $\phi$ is existential (i.e., is only in the scope of
% diamonds), and dually every $\nu$-variable in $\phi$ is universal (i.e., is 
% only in the scope of boxes).
% \end{enumerate}
% \end{proposition}
% \begin{proof}
% Both points are proved by an easy induction on the complexity of a formula. 
% For the first one,  it is enough to notice that if $\phi \in \cont{\muML}{q} 
% \cap \AFMC$, then $\mu q. \phi \in \AFMC$ by definition of $\cont{\muML}{q} $.
% \end{proof}

It is easy to verify that $\mucML \sse \mudML$.
Characteristic about $\mucML$ is that in a formula $\mu p. \phi \in \mucML$,
all occurrences of $p$ are \emph{existential} in the sense that they may be 
in the scope of a diamond but not of a box.
Furthermore, as an immediate consequence of Proposition \ref{prop:FVcont} we 
may make the following observation.

\begin{corollary}\label{cor:cont}
For every $\mucML$-formula $\mu p. \phi$, $\phi$ is continuous in $p$.
\end{corollary}

\btbs
\item
\textcolor{red}{EXAMPLES SHOWING STRICT INCLUSION OF EXPRESSIVITY}
\etbs
