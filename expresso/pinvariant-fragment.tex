
In this subsection we will define a construction that transforms an arbitrary automaton
$\bbA$ in $\AutWC(\olque)$ into an automaton $\bbA^{\bullet}$ in 
$\AutWC(\ofo)$, such that $\bbA$ and $\bbA^{\bullet}$ are related as 
in~\eqref{eq:crux}.
This construction is completely determined by the following translation at the
one-step level.

\begin{definition}
Using the fact
that by Corollary~\ref{cor:olquepositivenf}, any formula in ${\olque}^+(A)$ is 
equivalent to a disjunction of formulas of the form 
$\posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$, we define the translation 
$(-)^{\bullet} : {\olque}^+(A) \to \ofo^+(A)$ as follows.
We set
\[
\Big( \posdbnfolque{\vlist{T}}{\Pi}{\Sigma} \Big)^{\bullet} \df
\bigwedge_{i} \exists x_i. \tau^+_{T_i}(x_i) \land \forall x. \bigvee_{S\in\Sigma} \tau^+_S(x)
%\posdbnfofo{\vlist{T}\cup\Sigma},
\]
and for $\al = \bigvee_{i} \al_{i}$ we define $\al^{\bullet} \df \bigvee 
\al_{i}^{\bullet}$.
\end{definition}

The key property of this translation is the following.

\begin{proposition}
\label{p-1P}
For every one-step model $(D,V)$ and every $\al \in {\olque}^+(A)$ we have
\begin{equation}
\label{eq-1cr}
(D,V) \models \alpha^{\bullet} \text{ iff } (D\times \om,V_\pi) \models \alpha,
\end{equation}
where $V_{\pi}$ % =  f^{-1} \circ V$
 is the induced valuation given by 
$V_{\pi}(a) \df \{ (d,k) \mid d \in V(a), k\in\omega\}$.
\end{proposition}

\begin{proof}
Clearly it suffices to prove \eqref{eq-1cr} for formulas of the form
$\al = \posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$.
\smallskip

\noindent\fbox{$\Rightarrow$} 
Assume $(D,\val) \models \alpha^{\bullet}$, we will show that 
$(D\times \omega,\val_\pi) \models \posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$.
Let $d_i$ be such that $\tau_{T_i}^+(d_i)$ in $(D,\val)$. 
It is clear that the $(d_i,i)$ provide \emph{distinct} elements satisfying 
$\tau_{T_i}^+((d_i,i))$ in $(D\times\omega,\val_{\pi})$ and therefore the 
first-order existential part of $\alpha$ is satisfied. 
With a similar but easier argument it is straightforward that the existential 
generalized quantifier part of $\alpha$ is also satisfied.
%
% Turning to the universal parts of $\alpha$ we first show that every element of 
% $D\times\omega$, which does not have its type in $\vlist{T}$, 
% satisfies the positive part of some type in $\Sigma \cup \Pi$. 
% Actually, it is easy to prove a stronger claim: they satisfy the positive part 
% of a type in $\Sigma$. 
% This is direct from the universal part of $\alpha^{\bullet}$. 
% For the universal generalized quantifier we need to show that 
% $(D\times\omega,\val_{\pi}) \models \dqu y.\bigvee_{S\in\Sigma} \tau^+_S(y)$. 
% That is, only finitely many elements of $D\times\omega$ do not realize the 
% positive part of a type in $\Sigma$.
% Again from the universal part of $\posdbnfofo{\vlist{T}\cup\Sigma}$ we know 
% that \emph{every} element in $(D,\val)$ realizes the positive part of a type in 
% $\Sigma$. 
% Then the same applies to $(D\times\omega,\val_\pi)$, so that the set of elements 
% \emph{not} realizing the positive part of a type in $\Sigma$ is empty and thus,
% in particular, finite.
For the universal parts of $\posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$ it is enough to observe that, because of the universal part of $\alpha^\bullet$, \emph{every} $d\in D$ realizes a positive type in $\Sigma$. By construction, the same applies to $(D\times\omega,\val_{\pi})$, 
therefore this takes care of both universal quantifiers.
\medskip
		
\noindent\fbox{$\Leftarrow$} 
Assuming that $(D\times \omega,\val_\pi) \models 
\posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$,
we will show that $(D,\val) \models \alpha^\bullet$. 
The existential part of $\alpha^{\bullet}$ is trivial. 
For the universal part we have to show that every element of $D$ realizes the 
positive part of a type in $\Sigma$. 
Suppose not, and let $d\in D$ be such that $\lnot\tau_S^+(d)$ for all $S\in 
\Sigma$. 
Then we have $(D\times\omega,\val_\pi) \not\models \tau_S^+((d,k))$ for all $k$.
That is, there are infinitely many elements not realizing the positive part of 
any type in $\Sigma$. 
Hence we have $(D\times\omega,\val_\pi) \not\models \dqu y.\bigvee_{S\in\Sigma} 
\tau_S^+(y)$. 
Absurd, because that is part of $\posdbnfolque{\vlist{T}}{\Pi}{\Sigma}$.
\end{proof}
% \medskip

\noindent\fcnote[inline,nomargin]{%
Remark.
\textnormal{A little remark of why the above proof does not work for finite trees.
(1) On finite trees, any disjunct with $\Sigma\neq\emptyset$ is equivalent to $\bot$, hence we can assume $\Sigma=\emptyset.$
(2) Instead of taking $D\times\omega$ we have to take $D\times n$ for sufficiently large $n$.
(3) The $\Rightarrow$ direction fails since $\alpha^\bullet$ is always false for $\Sigma=\emptyset$.
(4) However, the same translation as for MSO probably works, that is, $\wmso /bis \equiv \muML$ over finite trees.}
\medskip
}

As a consequence of Proposition~\ref{p-1P} we obtain the following.

\begin{definition}
Given an automaton $\bbA = \tup{A,\tmap,\pmap,a_{I}}$ in $\Aut(\olque)$, define 
the automaton $\bbA^{\bullet} \df \tup{A,\tmap^{\bullet},\pmap,a_{I}}$ in 
$\Aut(\ofo)$ by putting, for each $(a,c) \in A \times C$:
\[
\tmap^{\bullet}(a,c) \df (\tmap(a,c))^{\bullet}.
\]
\end{definition}

\begin{proposition}
For any automaton $\bbA = \tup{A,\tmap,\pmap,a_{I}}$ in $\Aut(\olque)$, and any
model $\bbT$, $\bbA$ and $\bbT$ satisfy \eqref{eq:crux}.
\end{proposition}

\begin{proof}
The proof of this proposition is based on a fairly routine comparison of the 
acceptance games $\mathcal{A}(\bbA^{\bullet},\bbT)$ and 
$\mathcal{A}(\bbA,\bbT^{\om})$.
In a slightly more general setting, the details of this proof can be found 
in~\cite{Venxx}.
\end{proof}
\medskip

It remains to be checked that the construction $(-)^{\bullet}$, which has
been defined for arbitrary automata in $\Aut(\olque)$, transforms 
$\wmso$-automata into automata in the right class, viz., $\AutWC(\ofo)$.

\begin{proposition}
Let $\bbA \in \Aut(\olque)$.
If $\bbA \in \AutWC(\olque)$, then $\bbA^{\bullet} \in \AutWC(\ofo)$.
\end{proposition}

\begin{proof}
This proposition can be verified by a straightforward inspection, at the 
one-step level, that if a formula $\al \in {\olque}^+(A)$ belongs to the fragment 
$\cont{{\olque}^+}{a}(A)$, then its translation $\al^{\bullet}$ lands in 
the fragment $\cont{\ofo^+}{a}(A)$.
\end{proof}

\begin{remark}{\rm
As a corollary of the previous two propositions we find that 
\begin{itemize}
	\itemsep 0 pt
	\item $\Aut(\ofo) \equiv \Aut(\olque)/{\bis}$, and
	\item $\AutWC(\ofo) \equiv \AutWC(\olque)/{\bis}$.
\end{itemize}
In fact, we are dealing here with an instantiation of a more general phenomenon 
that is essentially coalgebraic in nature.
In~\cite{Venxx} it is proved that if $\llang$ and $\llang'$ are two one-step
languages that are connected by a translation $(-)^{\bullet}: \llang' \to 
\llang$ satisfying a condition similar to \eqref{eq-1cr}, then we find that 
$\Aut(\llang)$ corresponds to the bisimulation-invariant fragment of 
$\Aut(\llang')$: $\Aut(\llang) \equiv \Aut(\llang')/{\bis}$.
This subsection can be generalized to prove similar results relating
$\AutW(\llang)$ to $\AutW(\llang')$, and $\AutWC(\llang)$ to 
$\AutWC(\llang')$.
}\end{remark}
